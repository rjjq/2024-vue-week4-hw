import{s as k,r as l,u as C,a as y,o as V,b as D,c as m,d as p,e,w as h,v as _,f as N,g as S,h as B,i as E,j as T}from"./index-BbjktQmv.js";import{a as U,S as g}from"./sweetalert2-D8OhiPZJ.js";import{u as $}from"./loginStore-BVI4D_X-.js";const q={id:"loginPage",class:"bg-yellow"},I={class:"conatiner loginPage vhContainer"},L=e("div",{class:"side"},[e("a",{href:"#"},[e("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})]),e("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"})],-1),M={class:"formControls",action:"index.html"},R=e("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1),K=e("label",{class:"formControls_label",for:"email"},"Email",-1),P={key:0},j=e("label",{class:"formControls_label",for:"pwd"},"密碼",-1),z=["disabled"],A="https://todolist-api.hexschool.io",O={__name:"LoginView",setup(F){const f=$(),{email:v,nickname:w}=k(f),t=l({email:"",password:""}),n=l(!1),x=C(),i=async()=>{n.value=!0;try{const o=await U.post(`${A}/users/sign_in`,t.value);document.cookie=`todoToken=${o.data.token}; expires=${c(o.data.exp)}; path=/`,document.cookie=`todoNickName=${o.data.nickname} ; expires=${c(o.data.exp)}; path=/`,g.fire({icon:"success",title:"登入成功",text:"即將跳轉到todo頁面...",showConfirmButton:!1,timer:1e3}).then(()=>{v.value=t.value.email,w.value=o.data.nickname,x.push("/todo/all")})}catch(o){g.fire({icon:"error",title:"登入失敗",text:o.response.data.message})}finally{n.value=!1}},r=l(!1),b=()=>{r.value=t.value.email.trim()===""},c=o=>{const s=o*1e3;return new Date(s).toUTCString()},u=y();return V(()=>{t.value.email=u.query.email||"",t.value.password=u.query.password||""}),(o,s)=>{const d=D("router-link");return m(),p("div",q,[e("div",I,[L,e("div",null,[e("form",M,[R,K,h(e("input",{class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email","onUpdate:modelValue":s[0]||(s[0]=a=>t.value.email=a),autocomplete:"current-email",onBlur:b,required:""},null,544),[[_,t.value.email]]),r.value?(m(),p("span",P,"此欄位不可留空")):N("",!0),j,h(e("input",{class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼",onKeyup:S(i,["enter"]),"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.password=a),autocomplete:"current-password",required:""},null,544),[[_,t.value.password]]),e("input",{class:"formControls_btnSubmit",type:"button",value:"登入",onClick:i,disabled:n.value},null,8,z),B(d,{class:"formControls_btnLink",to:"/signUp"},{default:E(()=>[T("註冊帳號")]),_:1})])])])])}}};export{O as default};
