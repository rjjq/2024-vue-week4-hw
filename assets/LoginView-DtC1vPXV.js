import{s as g,r as f,u as w,a as x,o as v,b as k,c as b,d as C,e,w as c,v as u,f as y,g as D,h as S,i as V}from"./index-BgZp6ebe.js";import{a as N,S as d}from"./sweetalert2-D8OhiPZJ.js";import{u as T}from"./loginStore-ZTVYyOv_.js";const U={id:"loginPage",class:"bg-yellow"},$={class:"conatiner loginPage vhContainer"},q=e("div",{class:"side"},[e("a",{href:"#"},[e("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})]),e("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"})],-1),B={class:"formControls",action:"index.html"},I=e("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1),E=e("label",{class:"formControls_label",for:"email"},"Email",-1),M=e("span",null,"此欄位不可留空",-1),R=e("label",{class:"formControls_label",for:"pwd"},"密碼",-1),K="https://todolist-api.hexschool.io",A={__name:"LoginView",setup(L){const m=T(),{email:p,nickname:h}=g(m),t=f({email:"",password:""}),_=w(),n=async()=>{try{const o=await N.post(`${K}/users/sign_in`,t.value);document.cookie=`todoToken=${o.data.token}; expires=${l(o.data.exp)}; path=/`,document.cookie=`todoNickName=${o.data.nickname} ; expires=${l(o.data.exp)}; path=/`,d.fire({icon:"success",title:"登入成功",text:"即將跳轉到todo頁面...",showConfirmButton:!1,timer:1e3}).then(()=>{p.value=t.value.email,h.value=o.data.nickname,_.push("/todo/all")})}catch(o){d.fire({icon:"error",title:"登入失敗",text:o.response.data.message})}},l=o=>{const s=o*1e3;return new Date(s).toUTCString()},i=x();return v(()=>{t.value.email=i.query.email||"",t.value.password=i.query.password||""}),(o,s)=>{const r=k("router-link");return b(),C("div",U,[e("div",$,[q,e("div",null,[e("form",B,[I,E,c(e("input",{class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email","onUpdate:modelValue":s[0]||(s[0]=a=>t.value.email=a),autocomplete:"current-email",required:""},null,512),[[u,t.value.email]]),M,R,c(e("input",{class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼",onKeyup:y(n,["enter"]),"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.password=a),autocomplete:"current-password",required:""},null,544),[[u,t.value.password]]),e("input",{class:"formControls_btnSubmit",type:"button",value:"登入",onClick:n}),D(r,{class:"formControls_btnLink",to:"/signUp"},{default:S(()=>[V("註冊帳號")]),_:1})])])])])}}};export{A as default};
